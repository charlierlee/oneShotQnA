#among other things:
https://pacroy.medium.com/single-node-kubernetes-on-home-lab-using-microk8s-metallb-and-traefik-7bb1ea38fcc2


https://discuss.kubernetes.io/t/my-adventures-with-microk8s-to-enable-gpu-and-use-mig-on-a-dgx-a100/15366
microk8s enable gpu ^
to test: lsmod | grep -i -e cuda -e nvidia -e nouveau
shoud return nothing ^
update to latest:
sudo snap refresh microk8s --channel=latest/edge
then run: microk8s enable gpu
Troubleshooting:
microk8s inspect
sudo journalctl -u snap.microk8s.daemon-containerd -n 1000 --no-pager


microk8s enable host-access

docker push localhost:32000/summary

kompose --volumes hostPath convert
kompose --file docker-compose.yml --volumes hostPath convert

microk8s.kubectl apply -f summary-deployment.yaml
microk8s.kubectl apply -f summary-service.yaml
microk8s.kubectl apply -f metalLB-config.yaml

microk8s kubectl get all --all-namespaces
microk8s kubectl rollout restart deployment summary
microk8s kubectl rollout restart deployment
microk8s kubectl logs summary-b46cb75d8-qd7fv
microk8s kubectl expose deployment summary --type=NodePort --port=8501 --name=summary-service

microk8s kubectl port-forward service/summary 8501:8501 -n default

microk8s.kubectl describe pod
microk8s inspect

microk8s start
microk8s ctr images ls
microk8s kubectl exec -it summary-7c95bc4459-tzlbm -- /bin/bash
microk8s stop

# to remove all images:
# get all images that start with localhost:32000, output the results into image_ls file
sudo microk8s ctr images ls name~='localhost:32000' | awk {'print $1'} > image_ls 
# loop over file, remove each image
cat image_ls | while read line || [[ -n $line ]];
do
    microk8s ctr images rm $line
done;

microk8s kubectl delete --all pods --namespace=default
microk8s kubectl delete --all deployments --namespace=default
microk8s kubectl delete --all service --namespace=default

microk8s kubectl get netpol -n default
microk8s kubectl delete netpol fscrawler-net -n default
